<div data-controller="video" data-video-application-id-value="<%= params[:id] %>">

  <h2>Record Your Video</h2>

  <button type="button" id="start">Start</button>
  <button type="button" id="stop">Stop and upload</button>

  <div>
    <video id="live" width="300" height="200" autoplay muted style="border:1px solid black;"></video>
  </div>

  <h2>Uploaded Video</h2>
<div data-video-target="uploaded">
  <% if @video&.file&.attached? %>
    <video width="400" height="300" controls>
      <source src="<%= url_for(@video.file) %>" type="<%= @video.file.content_type %>">
      Your browser does not support the video tag.
    </video>

    <div class="mt-2" id="cloudinary-link">
      <label class="form-label d-block">Cloudinary link</label>
      <div style="display:flex;gap:8px;align-items:center;">
        <% cloudinary_url = url_for(@video.file) %>
        <input id="videoLink"
               type="text"
               readonly
               value="<%= cloudinary_url %>"
               class="form-control"
               style="flex:1;">
        <button type="button"
                class="btn btn-outline-secondary"
                onclick="navigator.clipboard.writeText(document.getElementById('videoLink').value)">
          Copy
        </button>
        <%= link_to "Open", cloudinary_url, target: "_blank", rel: "noopener", class: "btn btn-primary" %>
      </div>
    </div>
  <% else %>
    <p>No video uploaded yet.</p>
  <% end %>
</div>
