
<h1>Pick a Trait</h1>

<%= form_with url: trait_application_path(@application),
              method: :patch,
              local: true do |f| %>

  <div>
    <label for="trait_choice1">What tone do you prefer for your cover letter?</label>
    <%= select_tag :trait_choice1,
          options_for_select([["Select your tone...", ""], "Professional and formal", "Friendly and approachable", "Confident and assertive", "Enthusiastic and energetic"]) %>
  </div>

    <div>
    <label for="trait_choice1">What is your main professional strength?</label>
    <%= select_tag :trait_choice2,
        options_for_select([
          ["Select your main strength...", ""],
          "Technical expertise and problem-solving",
          "Leadership and team management",
          "Communication and collaboration",
          "Innovation and creative thinking",
          "Analytical and data-driven approach",
          "Other"
        ]),
        id: "trait_choice2" %>


  <%= text_field_tag :trait_choice2_other, "",
        placeholder: "Please specify...",
        id: "trait_choice2_other",
        style: "display:none;" %>
  </div>


<div>
    <label for="trait_choice3">How would you describe your experience level in this field?</label>
    <%= select_tag :trait_choice3,
        options_for_select([
          ["Select your experience level...", ""],
          "Entry level (0–2 years)",
          "Mid-level (3–5 years)",
          "Senior level (6–10 years)",
          "Expert level (10+ years)"
        ]),
        id: "trait_choice3" %>
</div>


<div>
    <label for="trait_choice4">What motivates you most in your career?</label>
    <%= select_tag :trait_choice4,
        options_for_select([
          ["Select your motivation...", ""],
          "Professional growth and learning",
          "Making a meaningful impact",
          "Solving complex challenges",
          "Working with great teams",
          "Building innovative solutions",
          "Other"
        ]),
        id: "trait_choice4" %>

        <%= text_field_tag :trait_choice4_other, "",
        placeholder: "Please specify...",
        id: "trait_choice4_other",
        style: "display:none;" %>

</div>

  <%= f.submit "Save and Continue" %>
<% end %>


<script>
  document.addEventListener("DOMContentLoaded", () => {
    const dropdown = document.getElementById("trait_choice2");
    const otherField = document.getElementById("trait_choice2_other");

    dropdown.addEventListener("change", () => {
      if (dropdown.value === "Other") {
        otherField.style.display = "block";
      } else {
        otherField.style.display = "none";
        otherField.value = "";
      }
    });
  });



  document.addEventListener("DOMContentLoaded", () => {
    const dropdown = document.getElementById("trait_choice4");
    const otherField = document.getElementById("trait_choice4_other");

    dropdown.addEventListener("change", () => {
      if (dropdown.value === "Other") {
        otherField.style.display = "block";
      } else {
        otherField.style.display = "none";
        otherField.value = "";
      }
    });
  });


    function setupOtherToggle(selectId, inputId) {
    const dd  = document.getElementById(selectId);
    const box = document.getElementById(inputId);
    if (!dd || !box) return;

    const toggle = () => {
      if (dd.value === "Other") {
        box.style.display = "block";
      } else {
        box.style.display = "none";
        box.value = "";
      }
    };

    dd.addEventListener("change", toggle);
    toggle(); // set initial state
  }

  // Works with both hard refresh and Turbo-driven navigation
  document.addEventListener("turbo:load", () => {
    setupOtherToggle("trait_choice2", "trait_choice2_other");
    // call setupOtherToggle for any other dropdowns with "Other"
    // setupOtherToggle("experience_level", "experience_level_other");
    // setupOtherToggle("motivation", "motivation_other");
  });

  // Optional: also support non-Turbo environments
  document.addEventListener("DOMContentLoaded", () => {
    setupOtherToggle("trait_choice2", "trait_choice2_other");
  });




   // Works with both hard refresh and Turbo-driven navigation
  document.addEventListener("turbo:load", () => {
    setupOtherToggle("trait_choice4", "trait_choice4_other");
    // call setupOtherToggle for any other dropdowns with "Other"
    // setupOtherToggle("experience_level", "experience_level_other");
    // setupOtherToggle("motivation", "motivation_other");
  });

  // Optional: also support non-Turbo environments
  document.addEventListener("DOMContentLoaded", () => {
    setupOtherToggle("trait_choice4", "trait_choice4_other");
  });
</script>
