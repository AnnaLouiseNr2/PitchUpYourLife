<h1 class="page-title">Generating your Cover Letter and Video Pitch</h1>
<h2 class="page-subtitle mb-5">
  Please wait a moment while we prepare your personalized documents
</h2>

<div class="d-flex justify-content-center">
  <div class="d-flex flex-column align-items-center p-5 rounded-4" style="max-width: 500px; width: 100%;">
    <div class="spinner-border text-primary mb-4" role="status" style="width: 4rem; height: 4rem;">
      <span class="visually-hidden">Loading...</span>
    </div>
    <h4 class="text-muted mb-3">Creating your documents...</h4>
    <div class="progress w-100 mb-3" style="height: 8px;">
      <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 75%"></div>
    </div>
    <small class="text-muted">This usually takes 10-20 seconds</small>
  </div>
</div>

<script>
  async function checkStatus() {
    const res = await fetch("<%= status_application_path(@application) %>");
    const json = await res.json();

    if (json.cl_status === "done" && json.video_status === "done") {
      window.location.href = "<%= overview_application_path(@application) %>";
    }
  }
  setInterval(checkStatus, 2000);
</script>
